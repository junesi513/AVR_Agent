2025-06-27 10:55:42,389 - vulnerability_analyzer - INFO - 취약점 분석기 초기화 완료 - ID: 1, Model: gemini-1_5-flash
2025-06-27 10:55:42,389 - vulnerability_analyzer - INFO - LLM 연결됨: GeminiInterface
2025-06-27 10:55:42,389 - vulnerability_analyzer - INFO - === Stage 1: 사전 작업 시작 ===
2025-06-27 10:55:42,389 - vulnerability_analyzer - INFO - AST 노드 추출 시작
2025-06-27 10:55:42,389 - vulnerability_analyzer - INFO - 파일 처리 중: ObjectArrayCodec.java
2025-06-27 10:55:42,390 - vulnerability_analyzer - INFO - AST 추출 완료 - 1 파일 처리
2025-06-27 10:55:42,390 - vulnerability_analyzer - INFO - === Stage 2: 취약점 분석 시작 ===
2025-06-27 10:55:42,390 - vulnerability_analyzer - INFO - 취약점 분석 중: ObjectArrayCodec.java
2025-06-27 10:55:42,390 - llm_response - INFO - === Gemini API 호출 시작 ===
2025-06-27 10:55:42,390 - llm_response - INFO - 모델: gemini-1.5-flash
2025-06-27 10:55:42,390 - llm_response - INFO - 온도: 0.1
2025-06-27 10:55:42,390 - llm_response - INFO - 프롬프트 (일부): As a Java security expert, perform comprehensive vulnerability analysis for CodeQL generation:

Method: ObjectArrayCodec
Signature: public ObjectArrayCodec(){ } public final void write(JSONSerializer ...
2025-06-27 10:55:52,028 - llm_response - INFO - Gemini 응답 성공
2025-06-27 10:55:52,028 - llm_response - INFO - 응답 길이: 5055 문자
2025-06-27 10:55:52,028 - llm_response - INFO - 응답 내용 (일부): ```json
{
  "vulnerabilities": [
    {
      "type": "Unsafe Deserialization",
      "description": "The code uses `serializer.write(array[i])` and `serializer.writeWithFieldName(item, end)`, which could lead to unsafe deserialization if the `serializer` object is vulnerable (e.g., using a vulnerabl...
2025-06-27 10:55:52,028 - llm_response - INFO - 응답이 너무 길어 일부만 표시됨 (총 5055 문자)
2025-06-27 10:55:52,029 - llm_interfaces - INFO - LLM 상세 응답 저장됨: log/llm_detailed_responses/gemini-1_5-flash/ObjectArrayCodec_20250627_105552_gemini.txt
2025-06-27 10:55:52,030 - vulnerability_analyzer - INFO - LLM 분석 성공: llm_gemini
2025-06-27 10:55:52,030 - vulnerability_analyzer - WARNING - CodeQL 규칙 생성 실패: 'CodeQLTemplateEngine' object has no attribute 'generate_taint_tracking_template'
2025-06-27 10:55:52,030 - vulnerability_analyzer - INFO - 규칙 저장됨: rule/VUL4J-1/gemini-1_5-flash/semgrep1-ObjectArrayCodec
2025-06-27 10:55:52,030 - vulnerability_analyzer - INFO - 규칙 저장됨: rule/VUL4J-1/gemini-1_5-flash/codeql1-ObjectArrayCodec
2025-06-27 10:55:52,030 - vulnerability_analyzer - INFO - Semgrep 비활성화됨 - CodeQL만 사용
2025-06-27 10:55:52,030 - vulnerability_analyzer - INFO - CodeQL 실행 중: ObjectArrayCodec
2025-06-27 10:55:52,030 - codeql - INFO - === CodeQL 분석 시작 ===
2025-06-27 10:55:52,030 - codeql - INFO - 규칙 파일: rule/VUL4J-1/gemini-1_5-flash/codeql1-ObjectArrayCodec
2025-06-27 10:55:52,030 - codeql - INFO - 대상 경로: benchmark/Java/VUL4J/VUL4J-1
2025-06-27 10:55:52,030 - codeql - INFO - 데이터베이스 경로: None
2025-06-27 10:55:52,030 - codeql - INFO - 새 CodeQL DB 생성: ./codeql/codeql_db_239797
2025-06-27 10:55:52,030 - codeql - INFO - DB 생성 명령어: codeql database create ./codeql/codeql_db_239797 --language=java --source-root=./maven-project --overwrite
2025-06-27 10:56:08,229 - codeql - INFO - DB 생성 반환 코드: 0
2025-06-27 10:56:08,230 - codeql - INFO - DB 생성 출력: [2025-06-27 10:55:54] [build-stdout] [2025-06-27 10:55:54] Build directory is .
[2025-06-27 10:55:54] [build-stdout] [2025-06-27 10:55:54] [autobuild] > mvn clean package -f pom.xml -B -V -e -Dfindbugs.skip -Dcheckstyle.skip -Dpmd.skip=true -Dspotbugs.skip -Denforcer.skip -Dmaven.javadoc.skip -DskipTests -Dmaven.test.skip.exec -Dlicense.skip=true -Drat.skip=true -Dspotless.check.skip=true
[2025-06-27 10:55:54] [build-stdout] [2025-06-27 10:55:54] [autobuild] Apache Maven 3.6.3
[2025-06-27 10:55:54] [build-stdout] [2025-06-27 10:55:54] [autobuild] Maven home: /usr/share/maven
[2025-06-27 10:55:54] [build-stdout] [2025-06-27 10:55:54] [autobuild] Java version: 11.0.27, vendor: Ubuntu, runtime: /usr/lib/jvm/java-11-openjdk-amd64
[2025-06-27 10:55:54] [build-stdout] [2025-06-27 10:55:54] [autobuild] Default locale: en_US, platform encoding: UTF-8
[2025-06-27 10:55:54] [build-stdout] [2025-06-27 10:55:54] [autobuild] OS name: "linux", version: "6.8.0-58-generic", arch: "amd64", family: "unix"
[2025-06-27 10:55:55] [build-stdout] [2025-06-27 10:55:55] [autobuild] [INFO] Error stacktraces are turned on.
[2025-06-27 10:55:55] [build-stdout] [2025-06-27 10:55:55] [autobuild] [INFO] Scanning for projects...
[2025-06-27 10:55:56] [build-stdout] [2025-06-27 10:55:56] [autobuild] [WARNING] 
[2025-06-27 10:55:56] [build-stdout] [2025-06-27 10:55:56] [autobuild] [WARNING] Some problems were encountered while building the effective model for com.example:vuln-analysis:jar:1.0.0
[2025-06-27 10:55:56] [build-stdout] [2025-06-27 10:55:56] [autobuild] [WARNING] 'dependencies.dependency.systemPath' for com.alibaba:fastjson:jar should not point at files within the project directory, ${project.basedir}/../fastjson.jar will be unresolvable by dependent projects @ line 25, column 25
[2025-06-27 10:55:56] [build-stdout] [2025-06-27 10:55:56] [autobuild] [WARNING] 
[2025-06-27 10:55:56] [build-stdout] [2025-06-27 10:55:56] [autobuild] [WARNING] It is highly recommended to fix these problems because they threaten the stability of your build.
[2025-06-27 10:55:56] [build-stdout] [2025-06-27 10:55:56] [autobuild] [WARNING] 
[2025-06-27 10:55:56] [build-stdout] [2025-06-27 10:55:56] [autobuild] [WARNING] For this reason, future Maven versions might no longer support building such malformed projects.
[2025-06-27 10:55:56] [build-stdout] [2025-06-27 10:55:56] [autobuild] [WARNING] 
[2025-06-27 10:55:56] [build-stdout] [2025-06-27 10:55:56] [autobuild] [INFO] 
[2025-06-27 10:55:56] [build-stdout] [2025-06-27 10:55:56] [autobuild] [INFO] ---------------------< com.example:vuln-analysis >----------------------
[2025-06-27 10:55:56] [build-stdout] [2025-06-27 10:55:56] [autobuild] [INFO] Building vuln-analysis 1.0.0
[2025-06-27 10:55:56] [build-stdout] [2025-06-27 10:55:56] [autobuild] [INFO] --------------------------------[ jar ]---------------------------------
[2025-06-27 10:55:56] [build-stdout] [2025-06-27 10:55:56] [autobuild] [INFO] 
[2025-06-27 10:55:56] [build-stdout] [2025-06-27 10:55:56] [autobuild] [INFO] --- maven-clean-plugin:2.5:clean (default-clean) @ vuln-analysis ---
[2025-06-27 10:55:56] [build-stdout] [2025-06-27 10:55:56] [autobuild] [INFO] Deleting /home/ace4_sijune/test/AVR/maven-project/target
[2025-06-27 10:55:56] [build-stdout] [2025-06-27 10:55:56] [autobuild] [INFO] 
[2025-06-27 10:55:56] [build-stdout] [2025-06-27 10:55:56] [autobuild] [INFO] --- maven-resources-plugin:2.6:resources (default-resources) @ vuln-analysis ---
[2025-06-27 10:55:56] [build-stdout] [2025-06-27 10:55:56] [autobuild] [INFO] Using 'UTF-8' encoding to copy filtered resources.
[2025-06-27 10:55:56] [build-stdout] [2025-06-27 10:55:56] [autobuild] [INFO] skip non existing resourceDirectory /home/ace4_sijune/test/AVR/maven-project/src/main/resources
[2025-06-27 10:55:56] [build-stdout] [2025-06-27 10:55:56] [autobuild] [INFO] 
[2025-06-27 10:55:56] [build-stdout] [2025-06-27 10:55:56] [autobuild] [INFO] --- maven-compiler-plugin:3.8.1:compile (default-compile) @ vuln-analysis ---
[2025-06-27 10:55:56] [build-stdout] [2025-06-27 10:55:56] [autobuild] [INFO] Changes detected - recompiling the module!
[2025-06-27 10:55:56] [build-stdout] [2025-06-27 10:55:56] [autobuild] [INFO] Compiling 1 source file to /home/ace4_sijune/test/AVR/maven-project/target/classes
[2025-06-27 10:55:56] [build-stdout] [2025-06-27 10:55:56] [autobuild] WARNING: An illegal reflective access operation has occurred
[2025-06-27 10:55:56] [build-stdout] [2025-06-27 10:55:56] [autobuild] WARNING: Illegal reflective access by com.semmle.extractor.java.interceptors.JavacToolInterceptor to method com.sun.tools.javac.file.PathFileObject$SimpleFileObject.toUri()
[2025-06-27 10:55:56] [build-stdout] [2025-06-27 10:55:56] [autobuild] WARNING: Please consider reporting this to the maintainers of com.semmle.extractor.java.interceptors.JavacToolInterceptor
[2025-06-27 10:55:56] [build-stdout] [2025-06-27 10:55:56] [autobuild] WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
[2025-06-27 10:55:56] [build-stdout] [2025-06-27 10:55:56] [autobuild] WARNING: All illegal access operations will be denied in a future release
[2025-06-27 10:56:01] [build-stdout] [2025-06-27 10:56:01] [autobuild] [INFO] 
[2025-06-27 10:56:01] [build-stdout] [2025-06-27 10:56:01] [autobuild] [INFO] --- maven-resources-plugin:2.6:testResources (default-testResources) @ vuln-analysis ---
[2025-06-27 10:56:01] [build-stdout] [2025-06-27 10:56:01] [autobuild] [INFO] Using 'UTF-8' encoding to copy filtered resources.
[2025-06-27 10:56:01] [build-stdout] [2025-06-27 10:56:01] [autobuild] [INFO] skip non existing resourceDirectory /home/ace4_sijune/test/AVR/maven-project/src/test/resources
[2025-06-27 10:56:01] [build-stdout] [2025-06-27 10:56:01] [autobuild] [INFO] 
[2025-06-27 10:56:01] [build-stdout] [2025-06-27 10:56:01] [autobuild] [INFO] --- maven-compiler-plugin:3.8.1:testCompile (default-testCompile) @ vuln-analysis ---
[2025-06-27 10:56:01] [build-stdout] [2025-06-27 10:56:01] [autobuild] [INFO] No sources to compile
[2025-06-27 10:56:01] [build-stdout] [2025-06-27 10:56:01] [autobuild] [INFO] 
[2025-06-27 10:56:01] [build-stdout] [2025-06-27 10:56:01] [autobuild] [INFO] --- maven-surefire-plugin:2.12.4:test (default-test) @ vuln-analysis ---
[2025-06-27 10:56:02] [build-stdout] [2025-06-27 10:56:02] [autobuild] [INFO] Tests are skipped.
[2025-06-27 10:56:02] [build-stdout] [2025-06-27 10:56:02] [autobuild] [INFO] 
[2025-06-27 10:56:02] [build-stdout] [2025-06-27 10:56:02] [autobuild] [INFO] --- maven-jar-plugin:2.4:jar (default-jar) @ vuln-analysis ---
[2025-06-27 10:56:02] [build-stdout] [2025-06-27 10:56:02] [autobuild] [INFO] Building jar: /home/ace4_sijune/test/AVR/maven-project/target/vuln-analysis-1.0.0.jar
[2025-06-27 10:56:02] [build-stdout] [2025-06-27 10:56:02] [autobuild] [INFO] ------------------------------------------------------------------------
[2025-06-27 10:56:02] [build-stdout] [2025-06-27 10:56:02] [autobuild] [INFO] BUILD SUCCESS
[2025-06-27 10:56:02] [build-stdout] [2025-06-27 10:56:02] [autobuild] [INFO] ------------------------------------------------------------------------
[2025-06-27 10:56:02] [build-stdout] [2025-06-27 10:56:02] [autobuild] [INFO] Total time:  6.190 s
[2025-06-27 10:56:02] [build-stdout] [2025-06-27 10:56:02] [autobuild] [INFO] Finished at: 2025-06-27T10:56:02+09:00
[2025-06-27 10:56:02] [build-stdout] [2025-06-27 10:56:02] [autobuild] [INFO] ------------------------------------------------------------------------
[2025-06-27 10:56:04] [build-stderr] Scanning for files in /home/ace4_sijune/test/AVR/maven-project...
[2025-06-27 10:56:04] [build-stderr] /home/ace4_sijune/test/AVR/codeql/codeql_db_239797: Indexing files in in /home/ace4_sijune/test/AVR/maven-project...
[2025-06-27 10:56:04] [build-stderr] Running command in /home/ace4_sijune/test/AVR/maven-project: [/opt/codeql/xml/tools/index-files.sh, /home/ace4_sijune/test/AVR/codeql/codeql_db_239797/working/files-to-index15525548757759960382.list]
[2025-06-27 10:56:05] [build-stderr] Scanning for files in /home/ace4_sijune/test/AVR/maven-project...
[2025-06-27 10:56:05] [build-stderr] /home/ace4_sijune/test/AVR/codeql/codeql_db_239797: Indexing files in in /home/ace4_sijune/test/AVR/maven-project...
[2025-06-27 10:56:05] [build-stderr] Running command in /home/ace4_sijune/test/AVR/maven-project: [/opt/codeql/properties/tools/index-files.sh, /home/ace4_sijune/test/AVR/codeql/codeql_db_239797/working/files-to-index9226686568665317510.list]

2025-06-27 10:56:08,230 - codeql - WARNING - DB 생성 에러: Initializing database at /home/ace4_sijune/test/AVR/codeql/codeql_db_239797.
Running build command: [/opt/codeql/java/tools/autobuild.sh]
Running command in /home/ace4_sijune/test/AVR/maven-project: [/opt/codeql/java/tools/autobuild.sh]
Finalizing database at /home/ace4_sijune/test/AVR/codeql/codeql_db_239797.
Running pre-finalize script /opt/codeql/java/tools/pre-finalize.sh in /home/ace4_sijune/test/AVR/maven-project.
Running command in /home/ace4_sijune/test/AVR/maven-project: [/opt/codeql/java/tools/pre-finalize.sh]
Running TRAP import for CodeQL database at /home/ace4_sijune/test/AVR/codeql/codeql_db_239797...
Importing TRAP files
Merging relations
Finished writing database (relations: 269.88 KiB; string pool: 2.41 MiB).
TRAP import complete (1.6s).
Finished zipping source archive (3.50 KiB).
Successfully created database at /home/ace4_sijune/test/AVR/codeql/codeql_db_239797.

2025-06-27 10:56:08,231 - codeql - INFO - 쿼리 파일 확장자 추가: rule/VUL4J-1/gemini-1_5-flash/codeql1-ObjectArrayCodec -> rule/VUL4J-1/gemini-1_5-flash/codeql1-ObjectArrayCodec.ql
2025-06-27 10:56:08,231 - codeql - INFO - qlpack.yml 생성됨: rule/VUL4J-1/gemini-1_5-flash/qlpack.yml
2025-06-27 10:56:08,232 - codeql - INFO - 쿼리 실행 명령어: codeql query run codeql1-ObjectArrayCodec.ql --database ../../../codeql/codeql_db_239797 --output codeql1-ObjectArrayCodec.ql.bqrs
2025-06-27 10:56:16,610 - codeql - INFO - 쿼리 실행 반환 코드: 0
2025-06-27 10:56:16,610 - codeql - WARNING - 쿼리 실행 에러: Compiling query plan for /home/ace4_sijune/test/AVR/rule/VUL4J-1/gemini-1_5-flash/codeql1-ObjectArrayCodec.ql.
WARNING: The @id property should be a valid query identifier. (/home/ace4_sijune/test/AVR/rule/VUL4J-1/gemini-1_5-flash/codeql1-ObjectArrayCodec.ql:1,1-7,4)
WARNING: A problem query must define one of the following properties: @severity, @problem.severity. (/home/ace4_sijune/test/AVR/rule/VUL4J-1/gemini-1_5-flash/codeql1-ObjectArrayCodec.ql:1,1-7,4)
[1/1] Found in cache: /home/ace4_sijune/test/AVR/rule/VUL4J-1/gemini-1_5-flash/codeql1-ObjectArrayCodec.ql.
Starting evaluation of vuln4j-queries/codeql1-ObjectArrayCodec.ql.
[1/1 eval 870ms] Evaluation done; writing results to /home/ace4_sijune/test/AVR/rule/VUL4J-1/gemini-1_5-flash/codeql1-ObjectArrayCodec.ql.bqrs.
Shutting down query evaluator.

2025-06-27 10:56:16,611 - codeql - INFO - 결과 디코딩 명령어: codeql bqrs decode codeql1-ObjectArrayCodec.ql.bqrs --format=csv
2025-06-27 10:56:17,286 - codeql - INFO - 디코딩 반환 코드: 0
2025-06-27 10:56:17,287 - codeql - INFO - CodeQL 분석 완료 - 1개 결과
2025-06-27 10:56:17,287 - codeql - INFO - 결과 #1: "m","col1"
2025-06-27 10:56:17,288 - codeql - INFO - 임시 쿼리 파일 삭제: rule/VUL4J-1/gemini-1_5-flash/codeql1-ObjectArrayCodec.ql
2025-06-27 10:56:17,288 - codeql - INFO - BQRS 파일 삭제: rule/VUL4J-1/gemini-1_5-flash/codeql1-ObjectArrayCodec.ql.bqrs
2025-06-27 10:56:17,288 - vulnerability_analyzer - INFO - CodeQL 검증 성공: 1개 발견
2025-06-27 10:56:17,288 - llm_response - INFO - === Gemini API 호출 시작 ===
2025-06-27 10:56:17,289 - llm_response - INFO - 모델: gemini-1.5-flash
2025-06-27 10:56:17,289 - llm_response - INFO - 온도: 0.1
2025-06-27 10:56:17,289 - llm_response - INFO - 프롬프트 (일부): As a Java security expert, perform comprehensive vulnerability analysis for CodeQL generation:

Method: write
Signature: public final void write(JSONSerializer serializer, Object object, Object fieldN...
2025-06-27 10:56:25,821 - llm_response - INFO - Gemini 응답 성공
2025-06-27 10:56:25,821 - llm_response - INFO - 응답 길이: 4441 문자
2025-06-27 10:56:25,821 - llm_response - INFO - 응답 내용 (일부): ```json
{
  "vulnerabilities": [
    {
      "type": "Unsafe Deserialization",
      "description": "The code uses a custom JSON serializer.  While not directly using a known vulnerable library like Fastjson or Jackson, the `serializer.write(array[i]);` and `serializer.writeWithFieldName(item, end);...
2025-06-27 10:56:25,821 - llm_response - INFO - 응답이 너무 길어 일부만 표시됨 (총 4441 문자)
2025-06-27 10:56:25,823 - llm_interfaces - INFO - LLM 상세 응답 저장됨: log/llm_detailed_responses/gemini-1_5-flash/write_20250627_105625_gemini.txt
2025-06-27 10:56:25,826 - vulnerability_analyzer - INFO - LLM 분석 성공: llm_gemini
2025-06-27 10:56:25,826 - vulnerability_analyzer - WARNING - CodeQL 규칙 생성 실패: 'CodeQLTemplateEngine' object has no attribute 'generate_taint_tracking_template'
2025-06-27 10:56:25,826 - vulnerability_analyzer - INFO - 규칙 저장됨: rule/VUL4J-1/gemini-1_5-flash/semgrep1-write
2025-06-27 10:56:25,826 - vulnerability_analyzer - INFO - 규칙 저장됨: rule/VUL4J-1/gemini-1_5-flash/codeql1-write
2025-06-27 10:56:25,826 - vulnerability_analyzer - INFO - Semgrep 비활성화됨 - CodeQL만 사용
2025-06-27 10:56:25,827 - vulnerability_analyzer - INFO - CodeQL 실행 중: write
2025-06-27 10:56:25,827 - codeql - INFO - === CodeQL 분석 시작 ===
2025-06-27 10:56:25,827 - codeql - INFO - 규칙 파일: rule/VUL4J-1/gemini-1_5-flash/codeql1-write
2025-06-27 10:56:25,827 - codeql - INFO - 대상 경로: benchmark/Java/VUL4J/VUL4J-1
2025-06-27 10:56:25,827 - codeql - INFO - 데이터베이스 경로: None
2025-06-27 10:56:25,827 - codeql - INFO - 기존 DB 삭제: ./codeql/codeql_db_239797
2025-06-27 10:56:25,842 - codeql - INFO - 새 CodeQL DB 생성: ./codeql/codeql_db_239797
2025-06-27 10:56:25,842 - codeql - INFO - DB 생성 명령어: codeql database create ./codeql/codeql_db_239797 --language=java --source-root=./maven-project --overwrite
2025-06-27 10:56:42,111 - codeql - INFO - DB 생성 반환 코드: 0
2025-06-27 10:56:42,112 - codeql - INFO - DB 생성 출력: [2025-06-27 10:56:28] [build-stdout] [2025-06-27 10:56:28] Build directory is .
[2025-06-27 10:56:28] [build-stdout] [2025-06-27 10:56:28] [autobuild] > mvn clean package -f pom.xml -B -V -e -Dfindbugs.skip -Dcheckstyle.skip -Dpmd.skip=true -Dspotbugs.skip -Denforcer.skip -Dmaven.javadoc.skip -DskipTests -Dmaven.test.skip.exec -Dlicense.skip=true -Drat.skip=true -Dspotless.check.skip=true
[2025-06-27 10:56:28] [build-stdout] [2025-06-27 10:56:28] [autobuild] Apache Maven 3.6.3
[2025-06-27 10:56:28] [build-stdout] [2025-06-27 10:56:28] [autobuild] Maven home: /usr/share/maven
[2025-06-27 10:56:28] [build-stdout] [2025-06-27 10:56:28] [autobuild] Java version: 11.0.27, vendor: Ubuntu, runtime: /usr/lib/jvm/java-11-openjdk-amd64
[2025-06-27 10:56:28] [build-stdout] [2025-06-27 10:56:28] [autobuild] Default locale: en_US, platform encoding: UTF-8
[2025-06-27 10:56:28] [build-stdout] [2025-06-27 10:56:28] [autobuild] OS name: "linux", version: "6.8.0-58-generic", arch: "amd64", family: "unix"
[2025-06-27 10:56:29] [build-stdout] [2025-06-27 10:56:29] [autobuild] [INFO] Error stacktraces are turned on.
[2025-06-27 10:56:29] [build-stdout] [2025-06-27 10:56:29] [autobuild] [INFO] Scanning for projects...
[2025-06-27 10:56:29] [build-stdout] [2025-06-27 10:56:29] [autobuild] [WARNING] 
[2025-06-27 10:56:29] [build-stdout] [2025-06-27 10:56:29] [autobuild] [WARNING] Some problems were encountered while building the effective model for com.example:vuln-analysis:jar:1.0.0
[2025-06-27 10:56:29] [build-stdout] [2025-06-27 10:56:29] [autobuild] [WARNING] 'dependencies.dependency.systemPath' for com.alibaba:fastjson:jar should not point at files within the project directory, ${project.basedir}/../fastjson.jar will be unresolvable by dependent projects @ line 25, column 25
[2025-06-27 10:56:29] [build-stdout] [2025-06-27 10:56:29] [autobuild] [WARNING] 
[2025-06-27 10:56:29] [build-stdout] [2025-06-27 10:56:29] [autobuild] [WARNING] It is highly recommended to fix these problems because they threaten the stability of your build.
[2025-06-27 10:56:29] [build-stdout] [2025-06-27 10:56:29] [autobuild] [WARNING] 
[2025-06-27 10:56:29] [build-stdout] [2025-06-27 10:56:29] [autobuild] [WARNING] For this reason, future Maven versions might no longer support building such malformed projects.
[2025-06-27 10:56:29] [build-stdout] [2025-06-27 10:56:29] [autobuild] [WARNING] 
[2025-06-27 10:56:29] [build-stdout] [2025-06-27 10:56:29] [autobuild] [INFO] 
[2025-06-27 10:56:29] [build-stdout] [2025-06-27 10:56:29] [autobuild] [INFO] ---------------------< com.example:vuln-analysis >----------------------
[2025-06-27 10:56:29] [build-stdout] [2025-06-27 10:56:29] [autobuild] [INFO] Building vuln-analysis 1.0.0
[2025-06-27 10:56:29] [build-stdout] [2025-06-27 10:56:29] [autobuild] [INFO] --------------------------------[ jar ]---------------------------------
[2025-06-27 10:56:30] [build-stdout] [2025-06-27 10:56:30] [autobuild] [INFO] 
[2025-06-27 10:56:30] [build-stdout] [2025-06-27 10:56:30] [autobuild] [INFO] --- maven-clean-plugin:2.5:clean (default-clean) @ vuln-analysis ---
[2025-06-27 10:56:30] [build-stdout] [2025-06-27 10:56:30] [autobuild] [INFO] Deleting /home/ace4_sijune/test/AVR/maven-project/target
[2025-06-27 10:56:30] [build-stdout] [2025-06-27 10:56:30] [autobuild] [INFO] 
[2025-06-27 10:56:30] [build-stdout] [2025-06-27 10:56:30] [autobuild] [INFO] --- maven-resources-plugin:2.6:resources (default-resources) @ vuln-analysis ---
[2025-06-27 10:56:30] [build-stdout] [2025-06-27 10:56:30] [autobuild] [INFO] Using 'UTF-8' encoding to copy filtered resources.
[2025-06-27 10:56:30] [build-stdout] [2025-06-27 10:56:30] [autobuild] [INFO] skip non existing resourceDirectory /home/ace4_sijune/test/AVR/maven-project/src/main/resources
[2025-06-27 10:56:30] [build-stdout] [2025-06-27 10:56:30] [autobuild] [INFO] 
[2025-06-27 10:56:30] [build-stdout] [2025-06-27 10:56:30] [autobuild] [INFO] --- maven-compiler-plugin:3.8.1:compile (default-compile) @ vuln-analysis ---
[2025-06-27 10:56:30] [build-stdout] [2025-06-27 10:56:30] [autobuild] [INFO] Changes detected - recompiling the module!
[2025-06-27 10:56:30] [build-stdout] [2025-06-27 10:56:30] [autobuild] [INFO] Compiling 1 source file to /home/ace4_sijune/test/AVR/maven-project/target/classes
[2025-06-27 10:56:30] [build-stdout] [2025-06-27 10:56:30] [autobuild] WARNING: An illegal reflective access operation has occurred
[2025-06-27 10:56:30] [build-stdout] [2025-06-27 10:56:30] [autobuild] WARNING: Illegal reflective access by com.semmle.extractor.java.interceptors.JavacToolInterceptor to method com.sun.tools.javac.file.PathFileObject$SimpleFileObject.toUri()
[2025-06-27 10:56:30] [build-stdout] [2025-06-27 10:56:30] [autobuild] WARNING: Please consider reporting this to the maintainers of com.semmle.extractor.java.interceptors.JavacToolInterceptor
[2025-06-27 10:56:30] [build-stdout] [2025-06-27 10:56:30] [autobuild] WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
[2025-06-27 10:56:30] [build-stdout] [2025-06-27 10:56:30] [autobuild] WARNING: All illegal access operations will be denied in a future release
[2025-06-27 10:56:35] [build-stdout] [2025-06-27 10:56:35] [autobuild] [INFO] 
[2025-06-27 10:56:35] [build-stdout] [2025-06-27 10:56:35] [autobuild] [INFO] --- maven-resources-plugin:2.6:testResources (default-testResources) @ vuln-analysis ---
[2025-06-27 10:56:35] [build-stdout] [2025-06-27 10:56:35] [autobuild] [INFO] Using 'UTF-8' encoding to copy filtered resources.
[2025-06-27 10:56:35] [build-stdout] [2025-06-27 10:56:35] [autobuild] [INFO] skip non existing resourceDirectory /home/ace4_sijune/test/AVR/maven-project/src/test/resources
[2025-06-27 10:56:35] [build-stdout] [2025-06-27 10:56:35] [autobuild] [INFO] 
[2025-06-27 10:56:35] [build-stdout] [2025-06-27 10:56:35] [autobuild] [INFO] --- maven-compiler-plugin:3.8.1:testCompile (default-testCompile) @ vuln-analysis ---
[2025-06-27 10:56:35] [build-stdout] [2025-06-27 10:56:35] [autobuild] [INFO] No sources to compile
[2025-06-27 10:56:35] [build-stdout] [2025-06-27 10:56:35] [autobuild] [INFO] 
[2025-06-27 10:56:35] [build-stdout] [2025-06-27 10:56:35] [autobuild] [INFO] --- maven-surefire-plugin:2.12.4:test (default-test) @ vuln-analysis ---
[2025-06-27 10:56:35] [build-stdout] [2025-06-27 10:56:35] [autobuild] [INFO] Tests are skipped.
[2025-06-27 10:56:35] [build-stdout] [2025-06-27 10:56:35] [autobuild] [INFO] 
[2025-06-27 10:56:35] [build-stdout] [2025-06-27 10:56:35] [autobuild] [INFO] --- maven-jar-plugin:2.4:jar (default-jar) @ vuln-analysis ---
[2025-06-27 10:56:36] [build-stdout] [2025-06-27 10:56:36] [autobuild] [INFO] Building jar: /home/ace4_sijune/test/AVR/maven-project/target/vuln-analysis-1.0.0.jar
[2025-06-27 10:56:36] [build-stdout] [2025-06-27 10:56:36] [autobuild] [INFO] ------------------------------------------------------------------------
[2025-06-27 10:56:36] [build-stdout] [2025-06-27 10:56:36] [autobuild] [INFO] BUILD SUCCESS
[2025-06-27 10:56:36] [build-stdout] [2025-06-27 10:56:36] [autobuild] [INFO] ------------------------------------------------------------------------
[2025-06-27 10:56:36] [build-stdout] [2025-06-27 10:56:36] [autobuild] [INFO] Total time:  6.267 s
[2025-06-27 10:56:36] [build-stdout] [2025-06-27 10:56:36] [autobuild] [INFO] Finished at: 2025-06-27T10:56:36+09:00
[2025-06-27 10:56:36] [build-stdout] [2025-06-27 10:56:36] [autobuild] [INFO] ------------------------------------------------------------------------
[2025-06-27 10:56:38] [build-stderr] Scanning for files in /home/ace4_sijune/test/AVR/maven-project...
[2025-06-27 10:56:38] [build-stderr] /home/ace4_sijune/test/AVR/codeql/codeql_db_239797: Indexing files in in /home/ace4_sijune/test/AVR/maven-project...
[2025-06-27 10:56:38] [build-stderr] Running command in /home/ace4_sijune/test/AVR/maven-project: [/opt/codeql/xml/tools/index-files.sh, /home/ace4_sijune/test/AVR/codeql/codeql_db_239797/working/files-to-index11018900873353492019.list]
[2025-06-27 10:56:39] [build-stderr] Scanning for files in /home/ace4_sijune/test/AVR/maven-project...
[2025-06-27 10:56:39] [build-stderr] /home/ace4_sijune/test/AVR/codeql/codeql_db_239797: Indexing files in in /home/ace4_sijune/test/AVR/maven-project...
[2025-06-27 10:56:39] [build-stderr] Running command in /home/ace4_sijune/test/AVR/maven-project: [/opt/codeql/properties/tools/index-files.sh, /home/ace4_sijune/test/AVR/codeql/codeql_db_239797/working/files-to-index11954263632311203165.list]

2025-06-27 10:56:42,112 - codeql - WARNING - DB 생성 에러: Initializing database at /home/ace4_sijune/test/AVR/codeql/codeql_db_239797.
Running build command: [/opt/codeql/java/tools/autobuild.sh]
Running command in /home/ace4_sijune/test/AVR/maven-project: [/opt/codeql/java/tools/autobuild.sh]
Finalizing database at /home/ace4_sijune/test/AVR/codeql/codeql_db_239797.
Running pre-finalize script /opt/codeql/java/tools/pre-finalize.sh in /home/ace4_sijune/test/AVR/maven-project.
Running command in /home/ace4_sijune/test/AVR/maven-project: [/opt/codeql/java/tools/pre-finalize.sh]
Running TRAP import for CodeQL database at /home/ace4_sijune/test/AVR/codeql/codeql_db_239797...
Importing TRAP files
Merging relations
Finished writing database (relations: 269.91 KiB; string pool: 2.41 MiB).
TRAP import complete (1.6s).
Finished zipping source archive (3.50 KiB).
Successfully created database at /home/ace4_sijune/test/AVR/codeql/codeql_db_239797.

2025-06-27 10:56:42,113 - codeql - INFO - 쿼리 파일 확장자 추가: rule/VUL4J-1/gemini-1_5-flash/codeql1-write -> rule/VUL4J-1/gemini-1_5-flash/codeql1-write.ql
2025-06-27 10:56:42,113 - codeql - INFO - 쿼리 실행 명령어: codeql query run codeql1-write.ql --database ../../../codeql/codeql_db_239797 --output codeql1-write.ql.bqrs
2025-06-27 10:56:50,249 - codeql - INFO - 쿼리 실행 반환 코드: 0
2025-06-27 10:56:50,249 - codeql - WARNING - 쿼리 실행 에러: Compiling query plan for /home/ace4_sijune/test/AVR/rule/VUL4J-1/gemini-1_5-flash/codeql1-write.ql.
WARNING: A problem query must define one of the following properties: @severity, @problem.severity. (/home/ace4_sijune/test/AVR/rule/VUL4J-1/gemini-1_5-flash/codeql1-write.ql:1,1-7,4)
[1/1] Found in cache: /home/ace4_sijune/test/AVR/rule/VUL4J-1/gemini-1_5-flash/codeql1-write.ql.
Starting evaluation of vuln4j-queries/codeql1-write.ql.
[1/1 eval 862ms] Evaluation done; writing results to /home/ace4_sijune/test/AVR/rule/VUL4J-1/gemini-1_5-flash/codeql1-write.ql.bqrs.
Shutting down query evaluator.

2025-06-27 10:56:50,250 - codeql - INFO - 결과 디코딩 명령어: codeql bqrs decode codeql1-write.ql.bqrs --format=csv
2025-06-27 10:56:50,929 - codeql - INFO - 디코딩 반환 코드: 0
2025-06-27 10:56:50,929 - codeql - INFO - CodeQL 분석 완료 - 53개 결과
2025-06-27 10:56:50,930 - codeql - INFO - 결과 #1: "m","col1"
2025-06-27 10:56:50,930 - codeql - INFO - 결과 #2: "write","Found write method at file:///home/ace4_sijune/test/AVR/fastjson.jar/com/alibaba/fastjson/serializer/JSONSerializer.class:0:0:0:0"
2025-06-27 10:56:50,930 - codeql - INFO - 결과 #3: "write","Found write method at file:///home/ace4_sijune/test/AVR/fastjson.jar/com/alibaba/fastjson/serializer/JSONSerializer.class:0:0:0:0"
2025-06-27 10:56:50,930 - codeql - INFO - 결과 #4: "write","Found write method at file:///home/ace4_sijune/test/AVR/fastjson.jar/com/alibaba/fastjson/serializer/JSONSerializer.class:0:0:0:0"
2025-06-27 10:56:50,930 - codeql - INFO - 결과 #5: "write","Found write method at file:///home/ace4_sijune/test/AVR/fastjson.jar/com/alibaba/fastjson/serializer/JSONSerializer.class:0:0:0:0"
2025-06-27 10:56:50,930 - codeql - INFO - 임시 쿼리 파일 삭제: rule/VUL4J-1/gemini-1_5-flash/codeql1-write.ql
2025-06-27 10:56:50,931 - codeql - INFO - BQRS 파일 삭제: rule/VUL4J-1/gemini-1_5-flash/codeql1-write.ql.bqrs
2025-06-27 10:56:50,931 - vulnerability_analyzer - INFO - CodeQL 검증 성공: 53개 발견
2025-06-27 10:56:50,931 - llm_response - INFO - === Gemini API 호출 시작 ===
2025-06-27 10:56:50,931 - llm_response - INFO - 모델: gemini-1.5-flash
2025-06-27 10:56:50,931 - llm_response - INFO - 온도: 0.1
2025-06-27 10:56:50,931 - llm_response - INFO - 프롬프트 (일부): As a Java security expert, perform comprehensive vulnerability analysis for CodeQL generation:

Method: deserialze
Signature: public <T> T deserialze(DefaultJSONParser parser, Type type, Object fieldN...
2025-06-27 10:56:59,099 - llm_response - INFO - Gemini 응답 성공
2025-06-27 10:56:59,099 - llm_response - INFO - 응답 길이: 4347 문자
2025-06-27 10:56:59,099 - llm_response - INFO - 응답 내용 (일부): ```json
{
  "vulnerabilities": [
    {
      "type": "Unsafe Deserialization",
      "description": "The `deserialize` method uses a JSON parser without sufficient input validation, potentially leading to unsafe deserialization vulnerabilities.  This is especially risky if the input JSON contains ma...
2025-06-27 10:56:59,100 - llm_response - INFO - 응답이 너무 길어 일부만 표시됨 (총 4347 문자)
2025-06-27 10:56:59,101 - llm_interfaces - INFO - LLM 상세 응답 저장됨: log/llm_detailed_responses/gemini-1_5-flash/deserialze_20250627_105659_gemini.txt
2025-06-27 10:56:59,101 - vulnerability_analyzer - INFO - LLM 분석 성공: llm_gemini
2025-06-27 10:56:59,101 - vulnerability_analyzer - WARNING - CodeQL 규칙 생성 실패: 'CodeQLTemplateEngine' object has no attribute 'generate_taint_tracking_template'
2025-06-27 10:56:59,102 - vulnerability_analyzer - INFO - 규칙 저장됨: rule/VUL4J-1/gemini-1_5-flash/semgrep1-deserialze
2025-06-27 10:56:59,102 - vulnerability_analyzer - INFO - 규칙 저장됨: rule/VUL4J-1/gemini-1_5-flash/codeql1-deserialze
2025-06-27 10:56:59,102 - vulnerability_analyzer - INFO - Semgrep 비활성화됨 - CodeQL만 사용
2025-06-27 10:56:59,102 - vulnerability_analyzer - INFO - CodeQL 실행 중: deserialze
2025-06-27 10:56:59,103 - codeql - INFO - === CodeQL 분석 시작 ===
2025-06-27 10:56:59,103 - codeql - INFO - 규칙 파일: rule/VUL4J-1/gemini-1_5-flash/codeql1-deserialze
2025-06-27 10:56:59,103 - codeql - INFO - 대상 경로: benchmark/Java/VUL4J/VUL4J-1
2025-06-27 10:56:59,103 - codeql - INFO - 데이터베이스 경로: None
2025-06-27 10:56:59,103 - codeql - INFO - 기존 DB 삭제: ./codeql/codeql_db_239797
2025-06-27 10:56:59,118 - codeql - INFO - 새 CodeQL DB 생성: ./codeql/codeql_db_239797
2025-06-27 10:56:59,119 - codeql - INFO - DB 생성 명령어: codeql database create ./codeql/codeql_db_239797 --language=java --source-root=./maven-project --overwrite
2025-06-27 10:57:15,614 - codeql - INFO - DB 생성 반환 코드: 0
2025-06-27 10:57:15,615 - codeql - INFO - DB 생성 출력: [2025-06-27 10:57:01] [build-stdout] [2025-06-27 10:57:01] Build directory is .
[2025-06-27 10:57:01] [build-stdout] [2025-06-27 10:57:01] [autobuild] > mvn clean package -f pom.xml -B -V -e -Dfindbugs.skip -Dcheckstyle.skip -Dpmd.skip=true -Dspotbugs.skip -Denforcer.skip -Dmaven.javadoc.skip -DskipTests -Dmaven.test.skip.exec -Dlicense.skip=true -Drat.skip=true -Dspotless.check.skip=true
[2025-06-27 10:57:02] [build-stdout] [2025-06-27 10:57:02] [autobuild] Apache Maven 3.6.3
[2025-06-27 10:57:02] [build-stdout] [2025-06-27 10:57:02] [autobuild] Maven home: /usr/share/maven
[2025-06-27 10:57:02] [build-stdout] [2025-06-27 10:57:02] [autobuild] Java version: 11.0.27, vendor: Ubuntu, runtime: /usr/lib/jvm/java-11-openjdk-amd64
[2025-06-27 10:57:02] [build-stdout] [2025-06-27 10:57:02] [autobuild] Default locale: en_US, platform encoding: UTF-8
[2025-06-27 10:57:02] [build-stdout] [2025-06-27 10:57:02] [autobuild] OS name: "linux", version: "6.8.0-58-generic", arch: "amd64", family: "unix"
[2025-06-27 10:57:03] [build-stdout] [2025-06-27 10:57:03] [autobuild] [INFO] Error stacktraces are turned on.
[2025-06-27 10:57:03] [build-stdout] [2025-06-27 10:57:03] [autobuild] [INFO] Scanning for projects...
[2025-06-27 10:57:03] [build-stdout] [2025-06-27 10:57:03] [autobuild] [WARNING] 
[2025-06-27 10:57:03] [build-stdout] [2025-06-27 10:57:03] [autobuild] [WARNING] Some problems were encountered while building the effective model for com.example:vuln-analysis:jar:1.0.0
[2025-06-27 10:57:03] [build-stdout] [2025-06-27 10:57:03] [autobuild] [WARNING] 'dependencies.dependency.systemPath' for com.alibaba:fastjson:jar should not point at files within the project directory, ${project.basedir}/../fastjson.jar will be unresolvable by dependent projects @ line 25, column 25
[2025-06-27 10:57:03] [build-stdout] [2025-06-27 10:57:03] [autobuild] [WARNING] 
[2025-06-27 10:57:03] [build-stdout] [2025-06-27 10:57:03] [autobuild] [WARNING] It is highly recommended to fix these problems because they threaten the stability of your build.
[2025-06-27 10:57:03] [build-stdout] [2025-06-27 10:57:03] [autobuild] [WARNING] 
[2025-06-27 10:57:03] [build-stdout] [2025-06-27 10:57:03] [autobuild] [WARNING] For this reason, future Maven versions might no longer support building such malformed projects.
[2025-06-27 10:57:03] [build-stdout] [2025-06-27 10:57:03] [autobuild] [WARNING] 
[2025-06-27 10:57:03] [build-stdout] [2025-06-27 10:57:03] [autobuild] [INFO] 
[2025-06-27 10:57:03] [build-stdout] [2025-06-27 10:57:03] [autobuild] [INFO] ---------------------< com.example:vuln-analysis >----------------------
[2025-06-27 10:57:03] [build-stdout] [2025-06-27 10:57:03] [autobuild] [INFO] Building vuln-analysis 1.0.0
[2025-06-27 10:57:03] [build-stdout] [2025-06-27 10:57:03] [autobuild] [INFO] --------------------------------[ jar ]---------------------------------
[2025-06-27 10:57:03] [build-stdout] [2025-06-27 10:57:03] [autobuild] [INFO] 
[2025-06-27 10:57:03] [build-stdout] [2025-06-27 10:57:03] [autobuild] [INFO] --- maven-clean-plugin:2.5:clean (default-clean) @ vuln-analysis ---
[2025-06-27 10:57:03] [build-stdout] [2025-06-27 10:57:03] [autobuild] [INFO] Deleting /home/ace4_sijune/test/AVR/maven-project/target
[2025-06-27 10:57:03] [build-stdout] [2025-06-27 10:57:03] [autobuild] [INFO] 
[2025-06-27 10:57:03] [build-stdout] [2025-06-27 10:57:03] [autobuild] [INFO] --- maven-resources-plugin:2.6:resources (default-resources) @ vuln-analysis ---
[2025-06-27 10:57:03] [build-stdout] [2025-06-27 10:57:03] [autobuild] [INFO] Using 'UTF-8' encoding to copy filtered resources.
[2025-06-27 10:57:03] [build-stdout] [2025-06-27 10:57:03] [autobuild] [INFO] skip non existing resourceDirectory /home/ace4_sijune/test/AVR/maven-project/src/main/resources
[2025-06-27 10:57:03] [build-stdout] [2025-06-27 10:57:03] [autobuild] [INFO] 
[2025-06-27 10:57:03] [build-stdout] [2025-06-27 10:57:03] [autobuild] [INFO] --- maven-compiler-plugin:3.8.1:compile (default-compile) @ vuln-analysis ---
[2025-06-27 10:57:04] [build-stdout] [2025-06-27 10:57:04] [autobuild] [INFO] Changes detected - recompiling the module!
[2025-06-27 10:57:04] [build-stdout] [2025-06-27 10:57:04] [autobuild] [INFO] Compiling 1 source file to /home/ace4_sijune/test/AVR/maven-project/target/classes
[2025-06-27 10:57:04] [build-stdout] [2025-06-27 10:57:04] [autobuild] WARNING: An illegal reflective access operation has occurred
[2025-06-27 10:57:04] [build-stdout] [2025-06-27 10:57:04] [autobuild] WARNING: Illegal reflective access by com.semmle.extractor.java.interceptors.JavacToolInterceptor to method com.sun.tools.javac.file.PathFileObject$SimpleFileObject.toUri()
[2025-06-27 10:57:04] [build-stdout] [2025-06-27 10:57:04] [autobuild] WARNING: Please consider reporting this to the maintainers of com.semmle.extractor.java.interceptors.JavacToolInterceptor
[2025-06-27 10:57:04] [build-stdout] [2025-06-27 10:57:04] [autobuild] WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
[2025-06-27 10:57:04] [build-stdout] [2025-06-27 10:57:04] [autobuild] WARNING: All illegal access operations will be denied in a future release
[2025-06-27 10:57:08] [build-stdout] [2025-06-27 10:57:08] [autobuild] [INFO] 
[2025-06-27 10:57:08] [build-stdout] [2025-06-27 10:57:08] [autobuild] [INFO] --- maven-resources-plugin:2.6:testResources (default-testResources) @ vuln-analysis ---
[2025-06-27 10:57:08] [build-stdout] [2025-06-27 10:57:08] [autobuild] [INFO] Using 'UTF-8' encoding to copy filtered resources.
[2025-06-27 10:57:08] [build-stdout] [2025-06-27 10:57:08] [autobuild] [INFO] skip non existing resourceDirectory /home/ace4_sijune/test/AVR/maven-project/src/test/resources
[2025-06-27 10:57:08] [build-stdout] [2025-06-27 10:57:08] [autobuild] [INFO] 
[2025-06-27 10:57:08] [build-stdout] [2025-06-27 10:57:08] [autobuild] [INFO] --- maven-compiler-plugin:3.8.1:testCompile (default-testCompile) @ vuln-analysis ---
[2025-06-27 10:57:08] [build-stdout] [2025-06-27 10:57:08] [autobuild] [INFO] No sources to compile
[2025-06-27 10:57:08] [build-stdout] [2025-06-27 10:57:08] [autobuild] [INFO] 
[2025-06-27 10:57:08] [build-stdout] [2025-06-27 10:57:08] [autobuild] [INFO] --- maven-surefire-plugin:2.12.4:test (default-test) @ vuln-analysis ---
[2025-06-27 10:57:09] [build-stdout] [2025-06-27 10:57:09] [autobuild] [INFO] Tests are skipped.
[2025-06-27 10:57:09] [build-stdout] [2025-06-27 10:57:09] [autobuild] [INFO] 
[2025-06-27 10:57:09] [build-stdout] [2025-06-27 10:57:09] [autobuild] [INFO] --- maven-jar-plugin:2.4:jar (default-jar) @ vuln-analysis ---
[2025-06-27 10:57:09] [build-stdout] [2025-06-27 10:57:09] [autobuild] [INFO] Building jar: /home/ace4_sijune/test/AVR/maven-project/target/vuln-analysis-1.0.0.jar
[2025-06-27 10:57:09] [build-stdout] [2025-06-27 10:57:09] [autobuild] [INFO] ------------------------------------------------------------------------
[2025-06-27 10:57:09] [build-stdout] [2025-06-27 10:57:09] [autobuild] [INFO] BUILD SUCCESS
[2025-06-27 10:57:09] [build-stdout] [2025-06-27 10:57:09] [autobuild] [INFO] ------------------------------------------------------------------------
[2025-06-27 10:57:09] [build-stdout] [2025-06-27 10:57:09] [autobuild] [INFO] Total time:  6.114 s
[2025-06-27 10:57:09] [build-stdout] [2025-06-27 10:57:09] [autobuild] [INFO] Finished at: 2025-06-27T10:57:09+09:00
[2025-06-27 10:57:09] [build-stdout] [2025-06-27 10:57:09] [autobuild] [INFO] ------------------------------------------------------------------------
[2025-06-27 10:57:11] [build-stderr] Scanning for files in /home/ace4_sijune/test/AVR/maven-project...
[2025-06-27 10:57:11] [build-stderr] /home/ace4_sijune/test/AVR/codeql/codeql_db_239797: Indexing files in in /home/ace4_sijune/test/AVR/maven-project...
[2025-06-27 10:57:11] [build-stderr] Running command in /home/ace4_sijune/test/AVR/maven-project: [/opt/codeql/xml/tools/index-files.sh, /home/ace4_sijune/test/AVR/codeql/codeql_db_239797/working/files-to-index10550053099063872145.list]
[2025-06-27 10:57:12] [build-stderr] Scanning for files in /home/ace4_sijune/test/AVR/maven-project...
[2025-06-27 10:57:13] [build-stderr] /home/ace4_sijune/test/AVR/codeql/codeql_db_239797: Indexing files in in /home/ace4_sijune/test/AVR/maven-project...
[2025-06-27 10:57:13] [build-stderr] Running command in /home/ace4_sijune/test/AVR/maven-project: [/opt/codeql/properties/tools/index-files.sh, /home/ace4_sijune/test/AVR/codeql/codeql_db_239797/working/files-to-index5519368026821310820.list]

2025-06-27 10:57:15,615 - codeql - WARNING - DB 생성 에러: Initializing database at /home/ace4_sijune/test/AVR/codeql/codeql_db_239797.
Running build command: [/opt/codeql/java/tools/autobuild.sh]
Running command in /home/ace4_sijune/test/AVR/maven-project: [/opt/codeql/java/tools/autobuild.sh]
Finalizing database at /home/ace4_sijune/test/AVR/codeql/codeql_db_239797.
Running pre-finalize script /opt/codeql/java/tools/pre-finalize.sh in /home/ace4_sijune/test/AVR/maven-project.
Running command in /home/ace4_sijune/test/AVR/maven-project: [/opt/codeql/java/tools/pre-finalize.sh]
Running TRAP import for CodeQL database at /home/ace4_sijune/test/AVR/codeql/codeql_db_239797...
Importing TRAP files
Merging relations
Finished writing database (relations: 269.91 KiB; string pool: 2.41 MiB).
TRAP import complete (1.7s).
Finished zipping source archive (3.50 KiB).
Successfully created database at /home/ace4_sijune/test/AVR/codeql/codeql_db_239797.

2025-06-27 10:57:15,616 - codeql - INFO - 쿼리 파일 확장자 추가: rule/VUL4J-1/gemini-1_5-flash/codeql1-deserialze -> rule/VUL4J-1/gemini-1_5-flash/codeql1-deserialze.ql
2025-06-27 10:57:15,616 - codeql - INFO - 쿼리 실행 명령어: codeql query run codeql1-deserialze.ql --database ../../../codeql/codeql_db_239797 --output codeql1-deserialze.ql.bqrs
2025-06-27 10:57:23,800 - codeql - INFO - 쿼리 실행 반환 코드: 0
2025-06-27 10:57:23,800 - codeql - WARNING - 쿼리 실행 에러: Compiling query plan for /home/ace4_sijune/test/AVR/rule/VUL4J-1/gemini-1_5-flash/codeql1-deserialze.ql.
WARNING: A problem query must define one of the following properties: @severity, @problem.severity. (/home/ace4_sijune/test/AVR/rule/VUL4J-1/gemini-1_5-flash/codeql1-deserialze.ql:1,1-7,4)
[1/1] Found in cache: /home/ace4_sijune/test/AVR/rule/VUL4J-1/gemini-1_5-flash/codeql1-deserialze.ql.
Starting evaluation of vuln4j-queries/codeql1-deserialze.ql.
[1/1 eval 849ms] Evaluation done; writing results to /home/ace4_sijune/test/AVR/rule/VUL4J-1/gemini-1_5-flash/codeql1-deserialze.ql.bqrs.
Shutting down query evaluator.

2025-06-27 10:57:23,800 - codeql - INFO - 결과 디코딩 명령어: codeql bqrs decode codeql1-deserialze.ql.bqrs --format=csv
2025-06-27 10:57:24,457 - codeql - INFO - 디코딩 반환 코드: 0
2025-06-27 10:57:24,457 - codeql - INFO - CodeQL 분석 완료 - 3개 결과
2025-06-27 10:57:24,457 - codeql - INFO - 결과 #1: "m","col1"
2025-06-27 10:57:24,458 - codeql - INFO - 결과 #2: "deserialze","Found deserialze method at file:///home/ace4_sijune/test/AVR/fastjson.jar/com/alibaba/fastjson/parser/deserializer/ObjectDeserializer.class:0:0:0:0"
2025-06-27 10:57:24,458 - codeql - INFO - 결과 #3: "deserialze","Found deserialze method at file:///home/ace4_sijune/test/AVR/maven-project/src/main/java/com/alibaba/fastjson/serializer/ObjectArrayCodec.java:128:18:128:27"
2025-06-27 10:57:24,458 - codeql - INFO - 임시 쿼리 파일 삭제: rule/VUL4J-1/gemini-1_5-flash/codeql1-deserialze.ql
2025-06-27 10:57:24,459 - codeql - INFO - BQRS 파일 삭제: rule/VUL4J-1/gemini-1_5-flash/codeql1-deserialze.ql.bqrs
2025-06-27 10:57:24,459 - vulnerability_analyzer - INFO - CodeQL 검증 성공: 3개 발견
2025-06-27 10:57:24,459 - llm_response - INFO - === Gemini API 호출 시작 ===
2025-06-27 10:57:24,459 - llm_response - INFO - 모델: gemini-1.5-flash
2025-06-27 10:57:24,459 - llm_response - INFO - 온도: 0.1
2025-06-27 10:57:24,459 - llm_response - INFO - 프롬프트 (일부): As a Java security expert, perform comprehensive vulnerability analysis for CodeQL generation:

Method: toObjectArray
Signature: private <T> T toObjectArray(DefaultJSONParser parser, Class<?> componen...
2025-06-27 10:57:32,393 - llm_response - INFO - Gemini 응답 성공
2025-06-27 10:57:32,394 - llm_response - INFO - 응답 길이: 4246 문자
2025-06-27 10:57:32,394 - llm_response - INFO - 응답 내용 (일부): ```json
{
  "vulnerabilities": [
    {
      "type": "Unsafe Deserialization",
      "description": "The method `toObjectArray` deserializes JSON data using a potentially vulnerable JSON parser.  If the input `array` contains malicious data, it could lead to arbitrary code execution or other securit...
2025-06-27 10:57:32,394 - llm_response - INFO - 응답이 너무 길어 일부만 표시됨 (총 4246 문자)
2025-06-27 10:57:32,395 - llm_interfaces - INFO - LLM 상세 응답 저장됨: log/llm_detailed_responses/gemini-1_5-flash/toObjectArray_20250627_105732_gemini.txt
2025-06-27 10:57:32,396 - vulnerability_analyzer - INFO - LLM 분석 성공: llm_gemini
2025-06-27 10:57:32,396 - vulnerability_analyzer - WARNING - CodeQL 규칙 생성 실패: 'CodeQLTemplateEngine' object has no attribute 'generate_taint_tracking_template'
2025-06-27 10:57:32,397 - vulnerability_analyzer - INFO - 규칙 저장됨: rule/VUL4J-1/gemini-1_5-flash/semgrep1-toObjectArray
2025-06-27 10:57:32,397 - vulnerability_analyzer - INFO - 규칙 저장됨: rule/VUL4J-1/gemini-1_5-flash/codeql1-toObjectArray
2025-06-27 10:57:32,397 - vulnerability_analyzer - INFO - Semgrep 비활성화됨 - CodeQL만 사용
2025-06-27 10:57:32,397 - vulnerability_analyzer - INFO - CodeQL 실행 중: toObjectArray
2025-06-27 10:57:32,397 - codeql - INFO - === CodeQL 분석 시작 ===
2025-06-27 10:57:32,397 - codeql - INFO - 규칙 파일: rule/VUL4J-1/gemini-1_5-flash/codeql1-toObjectArray
2025-06-27 10:57:32,397 - codeql - INFO - 대상 경로: benchmark/Java/VUL4J/VUL4J-1
2025-06-27 10:57:32,398 - codeql - INFO - 데이터베이스 경로: None
2025-06-27 10:57:32,398 - codeql - INFO - 기존 DB 삭제: ./codeql/codeql_db_239797
2025-06-27 10:57:32,414 - codeql - INFO - 새 CodeQL DB 생성: ./codeql/codeql_db_239797
2025-06-27 10:57:32,414 - codeql - INFO - DB 생성 명령어: codeql database create ./codeql/codeql_db_239797 --language=java --source-root=./maven-project --overwrite
2025-06-27 10:57:48,857 - codeql - INFO - DB 생성 반환 코드: 0
2025-06-27 10:57:48,858 - codeql - INFO - DB 생성 출력: [2025-06-27 10:57:34] [build-stdout] [2025-06-27 10:57:34] Build directory is .
[2025-06-27 10:57:35] [build-stdout] [2025-06-27 10:57:35] [autobuild] > mvn clean package -f pom.xml -B -V -e -Dfindbugs.skip -Dcheckstyle.skip -Dpmd.skip=true -Dspotbugs.skip -Denforcer.skip -Dmaven.javadoc.skip -DskipTests -Dmaven.test.skip.exec -Dlicense.skip=true -Drat.skip=true -Dspotless.check.skip=true
[2025-06-27 10:57:35] [build-stdout] [2025-06-27 10:57:35] [autobuild] Apache Maven 3.6.3
[2025-06-27 10:57:35] [build-stdout] [2025-06-27 10:57:35] [autobuild] Maven home: /usr/share/maven
[2025-06-27 10:57:35] [build-stdout] [2025-06-27 10:57:35] [autobuild] Java version: 11.0.27, vendor: Ubuntu, runtime: /usr/lib/jvm/java-11-openjdk-amd64
[2025-06-27 10:57:35] [build-stdout] [2025-06-27 10:57:35] [autobuild] Default locale: en_US, platform encoding: UTF-8
[2025-06-27 10:57:35] [build-stdout] [2025-06-27 10:57:35] [autobuild] OS name: "linux", version: "6.8.0-58-generic", arch: "amd64", family: "unix"
[2025-06-27 10:57:36] [build-stdout] [2025-06-27 10:57:36] [autobuild] [INFO] Error stacktraces are turned on.
[2025-06-27 10:57:36] [build-stdout] [2025-06-27 10:57:36] [autobuild] [INFO] Scanning for projects...
[2025-06-27 10:57:36] [build-stdout] [2025-06-27 10:57:36] [autobuild] [WARNING] 
[2025-06-27 10:57:36] [build-stdout] [2025-06-27 10:57:36] [autobuild] [WARNING] Some problems were encountered while building the effective model for com.example:vuln-analysis:jar:1.0.0
[2025-06-27 10:57:36] [build-stdout] [2025-06-27 10:57:36] [autobuild] [WARNING] 'dependencies.dependency.systemPath' for com.alibaba:fastjson:jar should not point at files within the project directory, ${project.basedir}/../fastjson.jar will be unresolvable by dependent projects @ line 25, column 25
[2025-06-27 10:57:36] [build-stdout] [2025-06-27 10:57:36] [autobuild] [WARNING] 
[2025-06-27 10:57:36] [build-stdout] [2025-06-27 10:57:36] [autobuild] [WARNING] It is highly recommended to fix these problems because they threaten the stability of your build.
[2025-06-27 10:57:36] [build-stdout] [2025-06-27 10:57:36] [autobuild] [WARNING] 
[2025-06-27 10:57:36] [build-stdout] [2025-06-27 10:57:36] [autobuild] [WARNING] For this reason, future Maven versions might no longer support building such malformed projects.
[2025-06-27 10:57:36] [build-stdout] [2025-06-27 10:57:36] [autobuild] [WARNING] 
[2025-06-27 10:57:36] [build-stdout] [2025-06-27 10:57:36] [autobuild] [INFO] 
[2025-06-27 10:57:36] [build-stdout] [2025-06-27 10:57:36] [autobuild] [INFO] ---------------------< com.example:vuln-analysis >----------------------
[2025-06-27 10:57:36] [build-stdout] [2025-06-27 10:57:36] [autobuild] [INFO] Building vuln-analysis 1.0.0
[2025-06-27 10:57:36] [build-stdout] [2025-06-27 10:57:36] [autobuild] [INFO] --------------------------------[ jar ]---------------------------------
[2025-06-27 10:57:36] [build-stdout] [2025-06-27 10:57:36] [autobuild] [INFO] 
[2025-06-27 10:57:36] [build-stdout] [2025-06-27 10:57:36] [autobuild] [INFO] --- maven-clean-plugin:2.5:clean (default-clean) @ vuln-analysis ---
[2025-06-27 10:57:36] [build-stdout] [2025-06-27 10:57:36] [autobuild] [INFO] Deleting /home/ace4_sijune/test/AVR/maven-project/target
[2025-06-27 10:57:36] [build-stdout] [2025-06-27 10:57:36] [autobuild] [INFO] 
[2025-06-27 10:57:36] [build-stdout] [2025-06-27 10:57:36] [autobuild] [INFO] --- maven-resources-plugin:2.6:resources (default-resources) @ vuln-analysis ---
[2025-06-27 10:57:37] [build-stdout] [2025-06-27 10:57:37] [autobuild] [INFO] Using 'UTF-8' encoding to copy filtered resources.
[2025-06-27 10:57:37] [build-stdout] [2025-06-27 10:57:37] [autobuild] [INFO] skip non existing resourceDirectory /home/ace4_sijune/test/AVR/maven-project/src/main/resources
[2025-06-27 10:57:37] [build-stdout] [2025-06-27 10:57:37] [autobuild] [INFO] 
[2025-06-27 10:57:37] [build-stdout] [2025-06-27 10:57:37] [autobuild] [INFO] --- maven-compiler-plugin:3.8.1:compile (default-compile) @ vuln-analysis ---
[2025-06-27 10:57:37] [build-stdout] [2025-06-27 10:57:37] [autobuild] [INFO] Changes detected - recompiling the module!
[2025-06-27 10:57:37] [build-stdout] [2025-06-27 10:57:37] [autobuild] [INFO] Compiling 1 source file to /home/ace4_sijune/test/AVR/maven-project/target/classes
[2025-06-27 10:57:37] [build-stdout] [2025-06-27 10:57:37] [autobuild] WARNING: An illegal reflective access operation has occurred
[2025-06-27 10:57:37] [build-stdout] [2025-06-27 10:57:37] [autobuild] WARNING: Illegal reflective access by com.semmle.extractor.java.interceptors.JavacToolInterceptor to method com.sun.tools.javac.file.PathFileObject$SimpleFileObject.toUri()
[2025-06-27 10:57:37] [build-stdout] [2025-06-27 10:57:37] [autobuild] WARNING: Please consider reporting this to the maintainers of com.semmle.extractor.java.interceptors.JavacToolInterceptor
[2025-06-27 10:57:37] [build-stdout] [2025-06-27 10:57:37] [autobuild] WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
[2025-06-27 10:57:37] [build-stdout] [2025-06-27 10:57:37] [autobuild] WARNING: All illegal access operations will be denied in a future release
[2025-06-27 10:57:42] [build-stdout] [2025-06-27 10:57:42] [autobuild] [INFO] 
[2025-06-27 10:57:42] [build-stdout] [2025-06-27 10:57:42] [autobuild] [INFO] --- maven-resources-plugin:2.6:testResources (default-testResources) @ vuln-analysis ---
[2025-06-27 10:57:42] [build-stdout] [2025-06-27 10:57:42] [autobuild] [INFO] Using 'UTF-8' encoding to copy filtered resources.
[2025-06-27 10:57:42] [build-stdout] [2025-06-27 10:57:42] [autobuild] [INFO] skip non existing resourceDirectory /home/ace4_sijune/test/AVR/maven-project/src/test/resources
[2025-06-27 10:57:42] [build-stdout] [2025-06-27 10:57:42] [autobuild] [INFO] 
[2025-06-27 10:57:42] [build-stdout] [2025-06-27 10:57:42] [autobuild] [INFO] --- maven-compiler-plugin:3.8.1:testCompile (default-testCompile) @ vuln-analysis ---
[2025-06-27 10:57:42] [build-stdout] [2025-06-27 10:57:42] [autobuild] [INFO] No sources to compile
[2025-06-27 10:57:42] [build-stdout] [2025-06-27 10:57:42] [autobuild] [INFO] 
[2025-06-27 10:57:42] [build-stdout] [2025-06-27 10:57:42] [autobuild] [INFO] --- maven-surefire-plugin:2.12.4:test (default-test) @ vuln-analysis ---
[2025-06-27 10:57:42] [build-stdout] [2025-06-27 10:57:42] [autobuild] [INFO] Tests are skipped.
[2025-06-27 10:57:42] [build-stdout] [2025-06-27 10:57:42] [autobuild] [INFO] 
[2025-06-27 10:57:42] [build-stdout] [2025-06-27 10:57:42] [autobuild] [INFO] --- maven-jar-plugin:2.4:jar (default-jar) @ vuln-analysis ---
[2025-06-27 10:57:42] [build-stdout] [2025-06-27 10:57:42] [autobuild] [INFO] ------------------------------------------------------------------------
[2025-06-27 10:57:42] [build-stdout] [2025-06-27 10:57:42] [autobuild] [INFO] BUILD SUCCESS
[2025-06-27 10:57:42] [build-stdout] [2025-06-27 10:57:42] [autobuild] [INFO] ------------------------------------------------------------------------
[2025-06-27 10:57:42] [build-stdout] [2025-06-27 10:57:42] [autobuild] [INFO] Total time:  6.162 s
[2025-06-27 10:57:42] [build-stdout] [2025-06-27 10:57:42] [autobuild] [INFO] Finished at: 2025-06-27T10:57:42+09:00
[2025-06-27 10:57:42] [build-stdout] [2025-06-27 10:57:42] [autobuild] [INFO] ------------------------------------------------------------------------
[2025-06-27 10:57:44] [build-stderr] Scanning for files in /home/ace4_sijune/test/AVR/maven-project...
[2025-06-27 10:57:44] [build-stderr] /home/ace4_sijune/test/AVR/codeql/codeql_db_239797: Indexing files in in /home/ace4_sijune/test/AVR/maven-project...
[2025-06-27 10:57:44] [build-stderr] Running command in /home/ace4_sijune/test/AVR/maven-project: [/opt/codeql/xml/tools/index-files.sh, /home/ace4_sijune/test/AVR/codeql/codeql_db_239797/working/files-to-index4338880158167742564.list]
[2025-06-27 10:57:46] [build-stderr] Scanning for files in /home/ace4_sijune/test/AVR/maven-project...
[2025-06-27 10:57:46] [build-stderr] /home/ace4_sijune/test/AVR/codeql/codeql_db_239797: Indexing files in in /home/ace4_sijune/test/AVR/maven-project...
[2025-06-27 10:57:46] [build-stderr] Running command in /home/ace4_sijune/test/AVR/maven-project: [/opt/codeql/properties/tools/index-files.sh, /home/ace4_sijune/test/AVR/codeql/codeql_db_239797/working/files-to-index14379042047230312356.list]

2025-06-27 10:57:48,858 - codeql - WARNING - DB 생성 에러: Initializing database at /home/ace4_sijune/test/AVR/codeql/codeql_db_239797.
Running build command: [/opt/codeql/java/tools/autobuild.sh]
Running command in /home/ace4_sijune/test/AVR/maven-project: [/opt/codeql/java/tools/autobuild.sh]
Finalizing database at /home/ace4_sijune/test/AVR/codeql/codeql_db_239797.
Running pre-finalize script /opt/codeql/java/tools/pre-finalize.sh in /home/ace4_sijune/test/AVR/maven-project.
Running command in /home/ace4_sijune/test/AVR/maven-project: [/opt/codeql/java/tools/pre-finalize.sh]
Running TRAP import for CodeQL database at /home/ace4_sijune/test/AVR/codeql/codeql_db_239797...
Importing TRAP files
Merging relations
Finished writing database (relations: 269.91 KiB; string pool: 2.41 MiB).
TRAP import complete (1.7s).
Finished zipping source archive (3.50 KiB).
Successfully created database at /home/ace4_sijune/test/AVR/codeql/codeql_db_239797.

2025-06-27 10:57:48,858 - codeql - INFO - 쿼리 파일 확장자 추가: rule/VUL4J-1/gemini-1_5-flash/codeql1-toObjectArray -> rule/VUL4J-1/gemini-1_5-flash/codeql1-toObjectArray.ql
2025-06-27 10:57:48,858 - codeql - INFO - 쿼리 실행 명령어: codeql query run codeql1-toObjectArray.ql --database ../../../codeql/codeql_db_239797 --output codeql1-toObjectArray.ql.bqrs
2025-06-27 10:57:57,453 - codeql - INFO - 쿼리 실행 반환 코드: 0
2025-06-27 10:57:57,454 - codeql - WARNING - 쿼리 실행 에러: Compiling query plan for /home/ace4_sijune/test/AVR/rule/VUL4J-1/gemini-1_5-flash/codeql1-toObjectArray.ql.
WARNING: The @id property should be a valid query identifier. (/home/ace4_sijune/test/AVR/rule/VUL4J-1/gemini-1_5-flash/codeql1-toObjectArray.ql:1,1-7,4)
WARNING: A problem query must define one of the following properties: @severity, @problem.severity. (/home/ace4_sijune/test/AVR/rule/VUL4J-1/gemini-1_5-flash/codeql1-toObjectArray.ql:1,1-7,4)
[1/1] Found in cache: /home/ace4_sijune/test/AVR/rule/VUL4J-1/gemini-1_5-flash/codeql1-toObjectArray.ql.
Starting evaluation of vuln4j-queries/codeql1-toObjectArray.ql.
[1/1 eval 923ms] Evaluation done; writing results to /home/ace4_sijune/test/AVR/rule/VUL4J-1/gemini-1_5-flash/codeql1-toObjectArray.ql.bqrs.
Shutting down query evaluator.

2025-06-27 10:57:57,454 - codeql - INFO - 결과 디코딩 명령어: codeql bqrs decode codeql1-toObjectArray.ql.bqrs --format=csv
2025-06-27 10:57:58,130 - codeql - INFO - 디코딩 반환 코드: 0
2025-06-27 10:57:58,131 - codeql - INFO - CodeQL 분석 완료 - 2개 결과
2025-06-27 10:57:58,131 - codeql - INFO - 결과 #1: "m","col1"
2025-06-27 10:57:58,131 - codeql - INFO - 결과 #2: "toObjectArray","Found toObjectArray method at file:///home/ace4_sijune/test/AVR/maven-project/src/main/java/com/alibaba/fastjson/serializer/ObjectArrayCodec.java:183:19:183:31"
2025-06-27 10:57:58,132 - codeql - INFO - 임시 쿼리 파일 삭제: rule/VUL4J-1/gemini-1_5-flash/codeql1-toObjectArray.ql
2025-06-27 10:57:58,132 - codeql - INFO - BQRS 파일 삭제: rule/VUL4J-1/gemini-1_5-flash/codeql1-toObjectArray.ql.bqrs
2025-06-27 10:57:58,132 - vulnerability_analyzer - INFO - CodeQL 검증 성공: 2개 발견
2025-06-27 10:57:58,132 - llm_response - INFO - === Gemini API 호출 시작 ===
2025-06-27 10:57:58,132 - llm_response - INFO - 모델: gemini-1.5-flash
2025-06-27 10:57:58,133 - llm_response - INFO - 온도: 0.1
2025-06-27 10:57:58,133 - llm_response - INFO - 프롬프트 (일부): As a Java security expert, perform comprehensive vulnerability analysis for CodeQL generation:

Method: getFastMatchToken
Signature: public int getFastMatchToken() { return JSONToken.LBRACKET; } }

Co...
2025-06-27 10:58:05,637 - llm_response - INFO - Gemini 응답 성공
2025-06-27 10:58:05,638 - llm_response - INFO - 응답 길이: 3897 문자
2025-06-27 10:58:05,638 - llm_response - INFO - 응답 내용 (일부): ```json
{
  "vulnerabilities": [
    {
      "type": "Unsafe Deserialization",
      "description": "The method `getFastMatchToken` always returns `JSONToken.LBRACKET`.  While this method itself doesn't directly perform deserialization, it's highly suspicious if this token is used to trigger parsing...
2025-06-27 10:58:05,638 - llm_response - INFO - 응답이 너무 길어 일부만 표시됨 (총 3897 문자)
2025-06-27 10:58:05,640 - llm_interfaces - INFO - LLM 상세 응답 저장됨: log/llm_detailed_responses/gemini-1_5-flash/getFastMatchToken_20250627_105805_gemini.txt
2025-06-27 10:58:05,640 - vulnerability_analyzer - INFO - LLM 분석 성공: llm_gemini
2025-06-27 10:58:05,640 - vulnerability_analyzer - WARNING - CodeQL 규칙 생성 실패: 'CodeQLTemplateEngine' object has no attribute 'generate_taint_tracking_template'
2025-06-27 10:58:05,641 - vulnerability_analyzer - INFO - 규칙 저장됨: rule/VUL4J-1/gemini-1_5-flash/semgrep1-getFastMatchToken
2025-06-27 10:58:05,641 - vulnerability_analyzer - INFO - 규칙 저장됨: rule/VUL4J-1/gemini-1_5-flash/codeql1-getFastMatchToken
2025-06-27 10:58:05,641 - vulnerability_analyzer - INFO - Semgrep 비활성화됨 - CodeQL만 사용
2025-06-27 10:58:05,641 - vulnerability_analyzer - INFO - CodeQL 실행 중: getFastMatchToken
2025-06-27 10:58:05,641 - codeql - INFO - === CodeQL 분석 시작 ===
2025-06-27 10:58:05,641 - codeql - INFO - 규칙 파일: rule/VUL4J-1/gemini-1_5-flash/codeql1-getFastMatchToken
2025-06-27 10:58:05,642 - codeql - INFO - 대상 경로: benchmark/Java/VUL4J/VUL4J-1
2025-06-27 10:58:05,642 - codeql - INFO - 데이터베이스 경로: None
2025-06-27 10:58:05,642 - codeql - INFO - 기존 DB 삭제: ./codeql/codeql_db_239797
2025-06-27 10:58:05,657 - codeql - INFO - 새 CodeQL DB 생성: ./codeql/codeql_db_239797
2025-06-27 10:58:05,658 - codeql - INFO - DB 생성 명령어: codeql database create ./codeql/codeql_db_239797 --language=java --source-root=./maven-project --overwrite
2025-06-27 10:58:22,406 - codeql - INFO - DB 생성 반환 코드: 0
2025-06-27 10:58:22,407 - codeql - INFO - DB 생성 출력: [2025-06-27 10:58:08] [build-stdout] [2025-06-27 10:58:08] Build directory is .
[2025-06-27 10:58:08] [build-stdout] [2025-06-27 10:58:08] [autobuild] > mvn clean package -f pom.xml -B -V -e -Dfindbugs.skip -Dcheckstyle.skip -Dpmd.skip=true -Dspotbugs.skip -Denforcer.skip -Dmaven.javadoc.skip -DskipTests -Dmaven.test.skip.exec -Dlicense.skip=true -Drat.skip=true -Dspotless.check.skip=true
[2025-06-27 10:58:08] [build-stdout] [2025-06-27 10:58:08] [autobuild] Apache Maven 3.6.3
[2025-06-27 10:58:08] [build-stdout] [2025-06-27 10:58:08] [autobuild] Maven home: /usr/share/maven
[2025-06-27 10:58:08] [build-stdout] [2025-06-27 10:58:08] [autobuild] Java version: 11.0.27, vendor: Ubuntu, runtime: /usr/lib/jvm/java-11-openjdk-amd64
[2025-06-27 10:58:08] [build-stdout] [2025-06-27 10:58:08] [autobuild] Default locale: en_US, platform encoding: UTF-8
[2025-06-27 10:58:08] [build-stdout] [2025-06-27 10:58:08] [autobuild] OS name: "linux", version: "6.8.0-58-generic", arch: "amd64", family: "unix"
[2025-06-27 10:58:09] [build-stdout] [2025-06-27 10:58:09] [autobuild] [INFO] Error stacktraces are turned on.
[2025-06-27 10:58:09] [build-stdout] [2025-06-27 10:58:09] [autobuild] [INFO] Scanning for projects...
[2025-06-27 10:58:09] [build-stdout] [2025-06-27 10:58:09] [autobuild] [WARNING] 
[2025-06-27 10:58:09] [build-stdout] [2025-06-27 10:58:09] [autobuild] [WARNING] Some problems were encountered while building the effective model for com.example:vuln-analysis:jar:1.0.0
[2025-06-27 10:58:09] [build-stdout] [2025-06-27 10:58:09] [autobuild] [WARNING] 'dependencies.dependency.systemPath' for com.alibaba:fastjson:jar should not point at files within the project directory, ${project.basedir}/../fastjson.jar will be unresolvable by dependent projects @ line 25, column 25
[2025-06-27 10:58:09] [build-stdout] [2025-06-27 10:58:09] [autobuild] [WARNING] 
[2025-06-27 10:58:09] [build-stdout] [2025-06-27 10:58:09] [autobuild] [WARNING] It is highly recommended to fix these problems because they threaten the stability of your build.
[2025-06-27 10:58:09] [build-stdout] [2025-06-27 10:58:09] [autobuild] [WARNING] 
[2025-06-27 10:58:09] [build-stdout] [2025-06-27 10:58:09] [autobuild] [WARNING] For this reason, future Maven versions might no longer support building such malformed projects.
[2025-06-27 10:58:09] [build-stdout] [2025-06-27 10:58:09] [autobuild] [WARNING] 
[2025-06-27 10:58:09] [build-stdout] [2025-06-27 10:58:09] [autobuild] [INFO] 
[2025-06-27 10:58:09] [build-stdout] [2025-06-27 10:58:09] [autobuild] [INFO] ---------------------< com.example:vuln-analysis >----------------------
[2025-06-27 10:58:09] [build-stdout] [2025-06-27 10:58:09] [autobuild] [INFO] Building vuln-analysis 1.0.0
[2025-06-27 10:58:09] [build-stdout] [2025-06-27 10:58:09] [autobuild] [INFO] --------------------------------[ jar ]---------------------------------
[2025-06-27 10:58:09] [build-stdout] [2025-06-27 10:58:09] [autobuild] [INFO] 
[2025-06-27 10:58:09] [build-stdout] [2025-06-27 10:58:09] [autobuild] [INFO] --- maven-clean-plugin:2.5:clean (default-clean) @ vuln-analysis ---
[2025-06-27 10:58:10] [build-stdout] [2025-06-27 10:58:10] [autobuild] [INFO] Deleting /home/ace4_sijune/test/AVR/maven-project/target
[2025-06-27 10:58:10] [build-stdout] [2025-06-27 10:58:10] [autobuild] [INFO] 
[2025-06-27 10:58:10] [build-stdout] [2025-06-27 10:58:10] [autobuild] [INFO] --- maven-resources-plugin:2.6:resources (default-resources) @ vuln-analysis ---
[2025-06-27 10:58:10] [build-stdout] [2025-06-27 10:58:10] [autobuild] [INFO] Using 'UTF-8' encoding to copy filtered resources.
[2025-06-27 10:58:10] [build-stdout] [2025-06-27 10:58:10] [autobuild] [INFO] skip non existing resourceDirectory /home/ace4_sijune/test/AVR/maven-project/src/main/resources
[2025-06-27 10:58:10] [build-stdout] [2025-06-27 10:58:10] [autobuild] [INFO] 
[2025-06-27 10:58:10] [build-stdout] [2025-06-27 10:58:10] [autobuild] [INFO] --- maven-compiler-plugin:3.8.1:compile (default-compile) @ vuln-analysis ---
[2025-06-27 10:58:10] [build-stdout] [2025-06-27 10:58:10] [autobuild] [INFO] Changes detected - recompiling the module!
[2025-06-27 10:58:10] [build-stdout] [2025-06-27 10:58:10] [autobuild] [INFO] Compiling 1 source file to /home/ace4_sijune/test/AVR/maven-project/target/classes
[2025-06-27 10:58:10] [build-stdout] [2025-06-27 10:58:10] [autobuild] WARNING: An illegal reflective access operation has occurred
[2025-06-27 10:58:10] [build-stdout] [2025-06-27 10:58:10] [autobuild] WARNING: Illegal reflective access by com.semmle.extractor.java.interceptors.JavacToolInterceptor to method com.sun.tools.javac.file.PathFileObject$SimpleFileObject.toUri()
[2025-06-27 10:58:10] [build-stdout] [2025-06-27 10:58:10] [autobuild] WARNING: Please consider reporting this to the maintainers of com.semmle.extractor.java.interceptors.JavacToolInterceptor
[2025-06-27 10:58:10] [build-stdout] [2025-06-27 10:58:10] [autobuild] WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
[2025-06-27 10:58:10] [build-stdout] [2025-06-27 10:58:10] [autobuild] WARNING: All illegal access operations will be denied in a future release
[2025-06-27 10:58:15] [build-stdout] [2025-06-27 10:58:15] [autobuild] [INFO] 
[2025-06-27 10:58:15] [build-stdout] [2025-06-27 10:58:15] [autobuild] [INFO] --- maven-resources-plugin:2.6:testResources (default-testResources) @ vuln-analysis ---
[2025-06-27 10:58:15] [build-stdout] [2025-06-27 10:58:15] [autobuild] [INFO] Using 'UTF-8' encoding to copy filtered resources.
[2025-06-27 10:58:15] [build-stdout] [2025-06-27 10:58:15] [autobuild] [INFO] skip non existing resourceDirectory /home/ace4_sijune/test/AVR/maven-project/src/test/resources
[2025-06-27 10:58:15] [build-stdout] [2025-06-27 10:58:15] [autobuild] [INFO] 
[2025-06-27 10:58:15] [build-stdout] [2025-06-27 10:58:15] [autobuild] [INFO] --- maven-compiler-plugin:3.8.1:testCompile (default-testCompile) @ vuln-analysis ---
[2025-06-27 10:58:15] [build-stdout] [2025-06-27 10:58:15] [autobuild] [INFO] No sources to compile
[2025-06-27 10:58:15] [build-stdout] [2025-06-27 10:58:15] [autobuild] [INFO] 
[2025-06-27 10:58:15] [build-stdout] [2025-06-27 10:58:15] [autobuild] [INFO] --- maven-surefire-plugin:2.12.4:test (default-test) @ vuln-analysis ---
[2025-06-27 10:58:15] [build-stdout] [2025-06-27 10:58:15] [autobuild] [INFO] Tests are skipped.
[2025-06-27 10:58:15] [build-stdout] [2025-06-27 10:58:15] [autobuild] [INFO] 
[2025-06-27 10:58:15] [build-stdout] [2025-06-27 10:58:15] [autobuild] [INFO] --- maven-jar-plugin:2.4:jar (default-jar) @ vuln-analysis ---
[2025-06-27 10:58:16] [build-stdout] [2025-06-27 10:58:16] [autobuild] [INFO] Building jar: /home/ace4_sijune/test/AVR/maven-project/target/vuln-analysis-1.0.0.jar
[2025-06-27 10:58:16] [build-stdout] [2025-06-27 10:58:16] [autobuild] [INFO] ------------------------------------------------------------------------
[2025-06-27 10:58:16] [build-stdout] [2025-06-27 10:58:16] [autobuild] [INFO] BUILD SUCCESS
[2025-06-27 10:58:16] [build-stdout] [2025-06-27 10:58:16] [autobuild] [INFO] ------------------------------------------------------------------------
[2025-06-27 10:58:16] [build-stdout] [2025-06-27 10:58:16] [autobuild] [INFO] Total time:  6.390 s
[2025-06-27 10:58:16] [build-stdout] [2025-06-27 10:58:16] [autobuild] [INFO] Finished at: 2025-06-27T10:58:16+09:00
[2025-06-27 10:58:16] [build-stdout] [2025-06-27 10:58:16] [autobuild] [INFO] ------------------------------------------------------------------------
[2025-06-27 10:58:18] [build-stderr] Scanning for files in /home/ace4_sijune/test/AVR/maven-project...
[2025-06-27 10:58:18] [build-stderr] /home/ace4_sijune/test/AVR/codeql/codeql_db_239797: Indexing files in in /home/ace4_sijune/test/AVR/maven-project...
[2025-06-27 10:58:18] [build-stderr] Running command in /home/ace4_sijune/test/AVR/maven-project: [/opt/codeql/xml/tools/index-files.sh, /home/ace4_sijune/test/AVR/codeql/codeql_db_239797/working/files-to-index4731426370954796400.list]
[2025-06-27 10:58:19] [build-stderr] Scanning for files in /home/ace4_sijune/test/AVR/maven-project...
[2025-06-27 10:58:19] [build-stderr] /home/ace4_sijune/test/AVR/codeql/codeql_db_239797: Indexing files in in /home/ace4_sijune/test/AVR/maven-project...
[2025-06-27 10:58:19] [build-stderr] Running command in /home/ace4_sijune/test/AVR/maven-project: [/opt/codeql/properties/tools/index-files.sh, /home/ace4_sijune/test/AVR/codeql/codeql_db_239797/working/files-to-index3840433476800264000.list]

2025-06-27 10:58:22,407 - codeql - WARNING - DB 생성 에러: Initializing database at /home/ace4_sijune/test/AVR/codeql/codeql_db_239797.
Running build command: [/opt/codeql/java/tools/autobuild.sh]
Running command in /home/ace4_sijune/test/AVR/maven-project: [/opt/codeql/java/tools/autobuild.sh]
Finalizing database at /home/ace4_sijune/test/AVR/codeql/codeql_db_239797.
Running pre-finalize script /opt/codeql/java/tools/pre-finalize.sh in /home/ace4_sijune/test/AVR/maven-project.
Running command in /home/ace4_sijune/test/AVR/maven-project: [/opt/codeql/java/tools/pre-finalize.sh]
Running TRAP import for CodeQL database at /home/ace4_sijune/test/AVR/codeql/codeql_db_239797...
Importing TRAP files
Merging relations
Finished writing database (relations: 269.91 KiB; string pool: 2.41 MiB).
TRAP import complete (1.7s).
Finished zipping source archive (3.50 KiB).
Successfully created database at /home/ace4_sijune/test/AVR/codeql/codeql_db_239797.

2025-06-27 10:58:22,408 - codeql - INFO - 쿼리 파일 확장자 추가: rule/VUL4J-1/gemini-1_5-flash/codeql1-getFastMatchToken -> rule/VUL4J-1/gemini-1_5-flash/codeql1-getFastMatchToken.ql
2025-06-27 10:58:22,408 - codeql - INFO - 쿼리 실행 명령어: codeql query run codeql1-getFastMatchToken.ql --database ../../../codeql/codeql_db_239797 --output codeql1-getFastMatchToken.ql.bqrs
2025-06-27 10:58:30,771 - codeql - INFO - 쿼리 실행 반환 코드: 0
2025-06-27 10:58:30,771 - codeql - WARNING - 쿼리 실행 에러: Compiling query plan for /home/ace4_sijune/test/AVR/rule/VUL4J-1/gemini-1_5-flash/codeql1-getFastMatchToken.ql.
WARNING: The @id property should be a valid query identifier. (/home/ace4_sijune/test/AVR/rule/VUL4J-1/gemini-1_5-flash/codeql1-getFastMatchToken.ql:1,1-7,4)
WARNING: A problem query must define one of the following properties: @severity, @problem.severity. (/home/ace4_sijune/test/AVR/rule/VUL4J-1/gemini-1_5-flash/codeql1-getFastMatchToken.ql:1,1-7,4)
[1/1] Found in cache: /home/ace4_sijune/test/AVR/rule/VUL4J-1/gemini-1_5-flash/codeql1-getFastMatchToken.ql.
Starting evaluation of vuln4j-queries/codeql1-getFastMatchToken.ql.
[1/1 eval 877ms] Evaluation done; writing results to /home/ace4_sijune/test/AVR/rule/VUL4J-1/gemini-1_5-flash/codeql1-getFastMatchToken.ql.bqrs.
Shutting down query evaluator.

2025-06-27 10:58:30,771 - codeql - INFO - 결과 디코딩 명령어: codeql bqrs decode codeql1-getFastMatchToken.ql.bqrs --format=csv
2025-06-27 10:58:31,427 - codeql - INFO - 디코딩 반환 코드: 0
2025-06-27 10:58:31,428 - codeql - INFO - CodeQL 분석 완료 - 4개 결과
2025-06-27 10:58:31,428 - codeql - INFO - 결과 #1: "m","col1"
2025-06-27 10:58:31,428 - codeql - INFO - 결과 #2: "getFastMatchToken","Found getFastMatchToken method at file:///home/ace4_sijune/test/AVR/fastjson.jar/com/alibaba/fastjson/parser/deserializer/FieldDeserializer.class:0:0:0:0"
2025-06-27 10:58:31,428 - codeql - INFO - 결과 #3: "getFastMatchToken","Found getFastMatchToken method at file:///home/ace4_sijune/test/AVR/fastjson.jar/com/alibaba/fastjson/parser/deserializer/ObjectDeserializer.class:0:0:0:0"
2025-06-27 10:58:31,428 - codeql - INFO - 결과 #4: "getFastMatchToken","Found getFastMatchToken method at file:///home/ace4_sijune/test/AVR/maven-project/src/main/java/com/alibaba/fastjson/serializer/ObjectArrayCodec.java:239:16:239:32"
2025-06-27 10:58:31,429 - codeql - INFO - 임시 쿼리 파일 삭제: rule/VUL4J-1/gemini-1_5-flash/codeql1-getFastMatchToken.ql
2025-06-27 10:58:31,429 - codeql - INFO - BQRS 파일 삭제: rule/VUL4J-1/gemini-1_5-flash/codeql1-getFastMatchToken.ql.bqrs
2025-06-27 10:58:31,429 - vulnerability_analyzer - INFO - CodeQL 검증 성공: 4개 발견
2025-06-27 10:58:31,429 - vulnerability_analyzer - INFO - 취약점 분석 완료 - 5개 발견
2025-06-27 10:58:31,429 - vulnerability_analyzer - INFO - === Stage 3: 패치 생성 시작 ===
2025-06-27 10:58:31,429 - vulnerability_analyzer - INFO - 패치 생성 중: ObjectArrayCodec
2025-06-27 10:58:31,429 - vulnerability_analyzer - INFO - 패치 생성 중: write
2025-06-27 10:58:31,430 - vulnerability_analyzer - INFO - 패치 생성 중: deserialze
2025-06-27 10:58:31,430 - vulnerability_analyzer - INFO - 패치 생성 중: toObjectArray
2025-06-27 10:58:31,430 - vulnerability_analyzer - INFO - 패치 생성 중: getFastMatchToken
2025-06-27 10:58:31,430 - vulnerability_analyzer - INFO - 패치 생성 완료 - 5개 생성
2025-06-27 10:58:31,435 - vulnerability_analyzer - INFO - 분석 결과 저장됨: log/gemini-1_5-flash/VUL4J-1/analysis_result_1_20250627_105831.json
2025-06-27 10:58:31,435 - improved_analysis - INFO - VUL4J-1 분석 완료
2025-06-27 10:58:31,441 - improved_analysis - INFO - 비교 결과 저장: log/improved/comparison/comparison_results_20250627_105831.json
2025-06-27 10:58:31,442 - improved_analysis - INFO - 요약 리포트 생성: log/improved/reports/summary_report_20250627_105831.md
2025-06-27 10:58:31,442 - improved_analysis - INFO - === 개선된 취약점 분석 완료 ===
