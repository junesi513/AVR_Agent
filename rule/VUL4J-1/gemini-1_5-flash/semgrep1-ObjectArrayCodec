rules:
  - id: vuln-1-objectarraycodec
    message: The code uses `serializer.write(array[i])` and `serializer.writeWithFieldName(item, end)`, which could lead to unsafe deserialization if the `serializer` object is vulnerable (e.g., using a vulnerable JSON library like a vulnerable version of Fastjson or Jackson).  The `array` elements are directly written without proper sanitization or validation, making it susceptible to attacks if the input array contains malicious objects.
    severity: HIGH
    languages: [java]
    pattern-either:
    metadata:
      category: security
      technology: [java]
      cwe: "CWE-502"
      confidence: HIGH